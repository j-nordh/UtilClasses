using System.Collections.Generic;
using UtilClasses.Core;
using Xunit;

namespace UtilClasses.Tests;

public class Pt100Tests
{
    [Fact]
    public void Identity()
    {
        Pt100Calculator calc = new Pt100Calculator(100, 0, 0);
        Assert.Equal(0, calc.GetTemp(100), 0.01);
    }

    [Theory]
    [MemberData(nameof(NegativeValues))]
    public void Negative(int expected, double resistance)
    {
        var calc = new Pt100Calculator(100.00692f, -1.965612E-02f, -1.958902E-04f);
        Assert.Equal(expected, calc.GetTemp(resistance), 0.1);
    }

    [Theory]
    [MemberData(nameof(PositiveValues))]
    public void Positive(int expected, double resistance)
    {
        var calc = new Pt100Calculator(100.00692f, -1.965612E-02f, -1.958902E-04f);
        Assert.Equal(expected, calc.GetTemp(resistance), 0.1);
    }

    public static IEnumerable<object[]> NegativeValues() => new List<object[]>()
    {
        {0, 100.00 },
        { -1, 99.61},
        { -2, 99.22},
        { -3, 98.83},
        { -4, 98.44},
        { -5, 98.04},
        { -6, 97.65},
        { -7, 97.26},
        { -8, 96.87},
        { -9, 96.48 },
        { -10, 96.09 },
        { -11, 95.69 },
        { -12, 95.30 },
        { -13, 94.91 },
        { -14, 94.52 },
        { -15, 94.12 },
        { -16, 93.73 },
        { -17, 93.34 },
        { -18, 92.95 },
        { -19, 92.55 },
        { -20, 92.16 },
        { -21, 91.77 },
        { -22, 91.37 },
        { -23, 90.98 },
        { -24, 90.59 },
        { -25, 90.19 },
        { -26, 89.80 },
        { -27, 89.40 },
        { -28, 89.01 },
        { -29, 88.62 },
        { -30, 88.22 },
        { -31, 87.83 },
        { -32, 87.43 },
        { -33, 87.04 },
        { -34, 86.64 },
        { -35, 86.25 },
        { -36, 85.85 },
        { -37, 85.46 },
        { -38, 85.06 },
        { -39, 84.67 },
        { -40, 84.27 },
        { -41, 83.87 },
        { -42, 83.48 },
        { -43, 83.08 },
        { -44, 82.69 },
        { -45, 82.29 },
        { -46, 81.89 },
        { -47, 81.50 },
        { -48, 81.10 },
        { -49, 80.70 },
        { -50, 80.31 },
        { -51, 79.91 },
        { -52, 79.51 },
        { -53, 79.11 },
        { -54, 78.72 },
        { -55, 78.32 },
        { -56, 77.92 },
        { -57, 77.52 },
        { -58, 77.12 },
        { -59, 76.73 } };

    public static IEnumerable<object[]> PositiveValues() => new List<object[]>()
    {
        {0, 100.00},
        {1, 100.39},
        {2, 100.78},
        {3, 101.17},
        {4, 101.56},
        {5, 101.95},
        {6, 102.34},
        {7, 102.73},
        {8, 103.12},
        {9, 103.51},
        {10, 103.90},
        {11, 104.29},
        {12, 104.68},
        {13, 105.07},
        {14, 105.46},
        {15, 105.85},
        {16, 106.24},
        {17, 106.63},
        {18, 107.02},
        {19, 107.40},
        {20, 107.79},
        {21, 108.18},
        {22, 108.57},
        {23, 108.96},
        {24, 109.35},
        {25, 109.73},
        {26, 110.12},
        {27, 110.51},
        {28, 110.90},
        {29, 111.29},
        {30, 111.67},
        {31, 112.06},
        {32, 112.45},
        {33, 112.83},
        {34, 113.22},
        {35, 113.61},
        {36, 114.00},
        {37, 114.38},
        {38, 114.77},
        {39, 115.15},
        {40, 115.54},
        {41, 115.93},
        {42, 116.31},
        {43, 116.70},
        {44, 117.08},
        {45, 117.47},
        {46, 117.86},
        {47, 118.24},
        {48, 118.63},
        {49, 119.01},
        {50, 119.40},
        {51, 119.78},
        {52, 120.17},
        {53, 120.55},
        {54, 120.94},
        {55, 121.32},
        {56, 121.71},
        {57, 122.09},
        {58, 122.47},
        {59, 122.86},
        {60, 123.24},
        {61, 123.63},
        {62, 124.01},
        {63, 124.39},
        {64, 124.78},
        {65, 125.16},
        {66, 125.54},
        {67, 125.93},
        {68, 126.31},
        {69, 126.69},
        {70, 127.08},
        {71, 127.46},
        {72, 127.84},
        {73, 128.22},
        {74, 128.61},
        {75, 128.99},
        {76, 129.37},
        {77, 129.75},
        {78, 130.13},
        {79, 130.52},
        {80, 130.90},
        {81, 131.28},
        {82, 131.66},
        {83, 132.04},
        {84, 132.42},
        {85, 132.80},
        {86, 133.18},
        {87, 133.57},
        {88, 133.95},
        {89, 134.33},
        {90, 134.71},
        {91, 135.09},
        {92, 135.47},
        {93, 135.85},
        {94, 136.23},
        {95, 136.61},
        {96, 136.99},
        {97, 137.37},
        {98, 137.75},
        {99, 138.13 }
        };
};

internal static class ListTestExtensions
{
    public static void Add(this List<object[]> list, params object[] os) => list.Add(os);
}